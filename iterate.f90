PROGRAM ITERITE
        REAL :: A(3,3),B(3),X0(3),X1(3),X2(3),X3(3),W(3),D(3,3),WORK(12),LWORK=12,T=0,C(3,3),E(3),F(4,4),G(4)
        REAL :: WR(3),WI(3),VL(3,3),VR(3,3)
        INTEGER :: IPIV(3),IPIV1(4),INFO,LDVL=3,LDVR=3
        A = RESHAPE((/8,4,6,-3,11,3,2,-1,12/),(/3,3/))
        C = RESHAPE((/2,1,-1,1,2,1,-1,1,2/),(/3,3/)) 
        D = RESHAPE((/15.456,0.00641,1.5527,0.00641,13.795,0.42585,1.5527,0.42585,10.749/),(/3,3/))
        !D = RESHAPE((/13.795,-0.00641,0.42585,-0.00641,15.456,-1.5527,0.42585,-1.5527,10.749/),(/3,3/))
        E = (/10.02,396.04,15803.46/)
        !F = RESHAPE((/53.0,69.525,99.296,146.877,69.525,99.296,146.877,222.278,96.296,146.877,222.278,341.902,146.877,222.278,341.902,332.432/),(/4,4/))
        F(:,1) = (/53.0,69.525,99.296,146.877/)
        F(:,2) = (/69.525,99.296,146.877,222.278/)
        F(:,3) = (/96.296,146.877,222.278,341.902/)
        F(:,4) = (/146.877,222.278,341.902,532.432/)
        G = (/61.042,78.107,110.193,161.794/)
        B = (/20,33,36/)
        X0 = (/0,0,0/)
        DO I=1,20
            X1(1) = (-A(1,2)*X0(2)-A(1,3)*X0(3)+B(1))/A(1,1)
            X1(2) = (-A(2,1)*X0(1)-A(2,3)*X0(3)+B(2))/A(2,2)
            X1(3) = (-A(3,1)*X0(1)-A(3,2)*X0(2)+B(3))/A(3,3)
            X0 = X1
        END DO

        DO I=1,20
            DO J=1,3
                DO K=1,3
                    IF (J .NE. K) THEN
                        T = T + A(J,K)*X0(K)
                    END IF
                END DO
                X2(J) = (B(J) - T)/A(J,J)
                T = 0
            END DO
            X0 = X2
        END DO

        !CALL SGESV(3,1,A,3,IPIV,B,3,INFO)
        CALL SSYEV('N','U',3,D,3,W,WORK,LWORK,INFO)
        !CALL SGEEV('N','V',3,C,3,WR,WI,VL,LDVL,VR,LDVR,WORK,LWORK,INFO)
        !CALL SSYEV('V','L',3,C,3,W,WORK,LWORK,INFO)
       ! PRINT *,B
       ! PRINT *,W
       ! PRINT *,WR
       ! PRINT *,WI
       ! PRINT *,VR
       ! CALL SGESV(4,1,F,4,IPIV1,G,4,INFO)
        PRINT *,W
END PROGRAM ITERITE
